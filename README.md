# kaggle-RANZCR
<img width="947" alt="スクリーンショット 2021-02-23 18 48 36" src="https://user-images.githubusercontent.com/70050531/108826575-cbbde300-7607-11eb-9edd-35ac39b4e8cd.png">
Kaggleの RANZCR CLiP - Catheter and Line Position Challenge コンペのリポジトリです。<br>

## 方針
- Kaggle上で完結させる。<br>
- Version名は常にVersion〇〇に統一して、変更などはKaggle日記(このリポジトリのREADMD.md)に書き込む。<br> 

## Basics<br>
### Overview(Deepl)<br>
深刻な合併症は、患者のラインやチューブの位置を間違えた結果として発生する可能性があります。医師や看護師は、患者を管理する際にプロトコルに従っていることを確認するために、救命器具を配置するためのチェックリストを頻繁に使用しています。しかし、これらの手順には時間がかかることがあり、特に病院の収容人数が多いストレスの多い状況では、人為的なミスが発生しやすい。<br> 

入院患者は入院中にカテーテルやラインを挿入されることがありますが、位置を誤ると重篤な合併症を引き起こす可能性があります。経鼻胃管の気道内への位置ずれは、症例の最大3％で報告されており、これらの症例の最大40％が合併症を示しています[1-3]。手術室外で挿管された成人患者の気道チューブの位置異常は、最大25％の症例で報告されています[4,5]。合併症の可能性は、手技者の経験レベルと専門性の両方に直接関係している。位置がずれたチューブを早期に発見することは、危険な合併症（死に至ることもある）を防ぐ鍵であり、何百万人ものCOVID-19患者がこれらのチューブやラインを必要としている現在ではなおさらである。<br> 

ラインとチューブの位置を確認するためのゴールドスタンダードは胸部X線写真である。しかし、医師や放射線技師は、ラインやチューブが最適な位置にあるかどうかを確認するために、これらの胸部X線写真を手動でチェックしなければならない。これはヒューマンエラーの可能性を残すだけでなく、放射線技師は他のスキャンの報告に忙しくなるため、遅延が生じることもよくあります。ディープラーニングアルゴリズムは、カテーテルやラインの位置が間違っていることを自動的に検出することができるかもしれない。警告が出れば、臨床医は命に関わる合併症を避けるために、カテーテルの位置を変更したり、除去したりすることができる。<br> 

Royal Australian and New Zealand College of Radiologists（RANZCR）は、オーストラリア、ニュージーランド、シンガポールの臨床放射線技師と放射線腫瘍医のための非営利の専門組織である。RANZCRは、不適切な位置に置かれたチューブやラインを予防可能なものとして認識している世界の多くの医療機関（NHSを含む）の一つである。RANZCRは、そのようなエラーがキャッチされる安全システムの設計を支援しています。<br> 

このコンペティションでは、胸部レントゲン上のカテーテルやラインの存在と位置を検出します。機械学習を使用して、40,000枚の画像上でモデルをトレーニングしてテストし、不適切な位置にあるチューブを分類します。<br> 

データセットには、ラベル付けとの整合性を確保するために、一連の定義でラベル付けを行いました。正常カテゴリには、適切に配置され、再配置を必要としない線が含まれます。境界線のカテゴリには，理想的には多少の再配置を必要とするが，ほとんどの場合，現在の位置でも十分に機能するであろう線が含まれる．異常カテゴリーには、直ちに再配置を必要とするラインが含まれる。<br> 

成功すれば、臨床医の命を救うことができるかもしれない。COVID-19の症例が急増し続ける中、位置がずれたカテーテルやラインを早期に発見することはさらに重要である。多くの病院では定員に達しており、これらのチューブやラインを必要としている患者が増えています。カテーテルやラインの配置に関する迅速なフィードバックは、臨床医がこれらの患者の治療を改善するのに役立つ可能性がある。COVID-19以外にも、ラインやチューブの位置を検出することは、多くの病 院患者にとって常に必要なことである。<br> 

### data(DeepL)<br>
このコンテストでは、胸部レントゲン上のカテーテルやラインの存在と位置を検出します。機械学習を使用して、40,000枚の画像上でモデルを訓練してテストし、配置の悪いチューブを分類してください。<br> 

#### What files do I need?<br> 

トレーニング画像とテスト画像が必要です。このコンテストはコードのみのコンテストなので、隠れたテストセット（約4倍の大きさで14k枚の画像）もあります。<br> 
train.csvには画像ID、バイナリラベル、患者IDが含まれています。<br>
TFRecordsは訓練とテストの両方で利用可能です。(これらは隠れたテストセットでも利用可能です)。<br>
train_annotations.csvも含まれています。これらは、それを持つ訓練サンプルのセグメンテーションアノテーションです。これらは，競合他社のための追加情報としてのみ含まれています<br> 

#### Files<br>
- train.csv - 画像ID、バイナリラベル、患者IDが格納されています．
sample_submission.csv - 正しいフォーマットのサンプル投稿ファイルです．
- test - テスト画像
train - トレーニングイメージ

#### Columns<br>
- StudyInstanceUID - 各画像に固有のID
- ETT-異常-気管内チューブ留置異常
- ETT - 境界線 - 気管内チューブ留置境界線異常
- ETT - 正常 - 気管支内チューブの装着は正常です。
- NGT-異常-経鼻胃管留置異常
- NGT - 境界線 - 経鼻胃管留置境界線異常
- NGT - 画像化が不完全 - 画像化のために経鼻胃管留置が決定的ではない
- NGT - 正常 - 経鼻胃管留置は正常の境界線上にある。
- CVC - 異常 - 中心静脈カテーテル留置異常
- CVC - ボーダーライン - 中心静脈カテーテル留置境界異常
- CVC - 正常 - 中心静脈カテーテルの配置は正常です。
- スワンガンツカテーテルプレゼント
- PatientID - データセット内の各患者の一意のID

## Paper<br>

## Log<br>
### 20210223<br>
- join!!!<br>
- cassavaコンペのリベンジ。まだ3週間はあるので色々できるはず。<br>
- nb001(EDA)<br>
  - 自力でEDAを行った。
  - キャッサバコンペに比べて画像データがかなり大きい。512×512ぐらいに縮小してもいいとは思う。
  - 画像データは3チャネルあったが、3チャネル全てが同じであるため、平均をとって1チャネルの白黒画像にしても全く同じになる。それなら1チャネルだけの方が軽くていいと思う。<br>
  - 適当に閾値を設定して、それ以下の値のピクセルを全部0するのも良さそう。<br>
  - アノテーション画像を使うなら、画像データの縮小に合わせてアノテーション画像も縮小させる必要がある。(まだどう使えばいいのかよくわかってないけど...)<br>
  - クラスの割合が予想以上に不均衡だった。MoAコンペでは、ほとんどが0のクラスは、罰則を小さくすることしか学習できていなかったため、今回も気をつける必要があるかもしれない。<br>
  - とりあえず、trainingデータの平均でsample_submissionの表を埋めてsubmitしてみた。->LBは0.500だった。AUCだから当然か。<br>

